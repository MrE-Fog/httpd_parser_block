This is apache log check in http://phorum.study-area.org.
This perl scipt can parser httpd log to found some not safe activity, and parser ip to apache block file.


Check item:
1.Client request too many 4xx web.

TODO:
Check URL include /etc/passwd


config file example:
arraylimit:1000
	- Read 1000 line to check.
status4xxlimit:20
	- Limit of 4xx status in Read line, Block Rule
apacheblockfile:/etc/httpd/conf.d/phorum-block.conf
	- Apache configure file location.
seek:23456
	- Save File seek, do not modify this line

Output of Apache configure file:
==============================================================================================
#Do not edit this file, this is config by httpd_parser_block, you maybe found it in crontab.
<Directory /var/www/html/phorum.study-area.org>
	SetEnvIF X-Forwarded-For "(,| |^)1\.11\.22\.33 (,| |$)" DenyIP
	SetEnvIF X-Forwarded-For "(,| |^)55\.66\.77\.88 (,| |$)" DenyIP

    Order allow,deny
    Deny from env=DenyIP
    Allow from all
</Directory>
==============================================================================================

Study-Area, Open Source Group in Taiwan
http://phorum.study-area.org
haway@study-area.org
